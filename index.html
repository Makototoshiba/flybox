<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Flybox — Курьер & Посылки</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:400,700&display=swap">
  <style>
    body {
      background: #f6f8fa;
      font-family: 'Montserrat', Arial, sans-serif;
      color: #24292f;
      margin: 0;
      padding: 0;
    }
    header {
      background: #24292f;
      color: #fff;
      font-weight: bold;
      font-size: 1.6rem;
      letter-spacing: .03em;
      text-align: center;
      padding: 1.1rem 0 .7rem 0;
      margin-bottom: 1.5rem;
      box-shadow: 0 1px 0 #e1e4e8;
      border-bottom: 1px solid #e1e4e8;
      user-select: none;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.7em;
    }
    .github-logo {
      width: 2em;
      height: 2em;
      vertical-align: middle;
      margin-right: 0.3em;
      display: inline-block;
    }
    main {
      max-width: 1100px;
      margin: 0 auto;
      padding: 0 2vw 2rem 2vw;
    }
    .top-bar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1rem;
      gap: 1.5rem;
    }
    .top-bar .search-panel {
      flex: 1 1 0;
      margin: 0;
      box-shadow: none;
      border-radius: 6px;
    }
    .add-btn {
      background: #2da44e;
      color: #fff;
      border: none;
      border-radius: 6px;
      font-weight: 700;
      font-size: 1rem;
      padding: .75em 1.4em;
      cursor: pointer;
      transition: background .13s;
      box-shadow: 0 1px 0 #e1e4e8;
      margin-left: auto;
      margin-bottom: 0;
      margin-top: 0;
    }
    .add-btn:hover { background: #238636; }
    .search-panel {
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      gap: .7rem;
      background: #fff;
      border: 1px solid #d0d7de;
      border-radius: 6px;
      margin-bottom: 0;
      padding: 1rem 1.3rem .9rem 1.3rem;
      box-shadow: 0 1px 0 #e1e4e8;
    }
    .search-panel input[type="text"] {
      flex: 2 1 180px;
      padding: .6em 1em;
      font-size: 1rem;
      border: 1px solid #d0d7de;
      border-radius: 6px;
      background: #f6f8fa;
      margin-right: .5rem;
      font-family: inherit;
      color: #24292f;
      transition: border-color .13s;
    }
    .search-panel input[type="text"]:focus {
      border-color: #0969da;
      background: #fff;
      outline: none;
    }
    .search-panel .search-btn {
      padding: .6em 1em;
      background: #2da44e;
      color: #fff;
      border: none;
      border-radius: 6px;
      font-size: 1rem;
      font-weight: 700;
      cursor: pointer;
      transition: background .13s;
      margin-right: .5rem;
      box-shadow: 0 1px 0 #e1e4e8;
    }
    .search-panel .search-btn:hover {
      background: #238636;
    }
    .search-panel .filter-switch {
      display: flex;
      gap: 0.4em;
      align-items: center;
      background: #f6f8fa;
      border-radius: 6px;
      padding: 0 .3em;
      font-size: .99em;
      font-weight: 700;
    }
    .search-panel .filter-switch button {
      background: none;
      border: 1px solid transparent;
      color: #0969da;
      font-weight: 700;
      font-size: 1em;
      padding: 0.18em 0.7em;
      border-radius: 6px;
      cursor: pointer;
      transition: border .13s, color .13s, background .13s;
    }
    .search-panel .filter-switch button.active {
      border: 1px solid #0969da;
      color: #fff;
      background: #0969da;
    }
    .list-title {
      font-size: 1.03rem;
      color: #57606a;
      margin-bottom: .3rem;
      font-weight: 700;
      border-bottom: 1px solid #d0d7de;
      padding-bottom: .2rem;
      text-align: left;
      letter-spacing: .01em;
    }
    .ads-table-container {
      width: 100%;
      overflow-x: auto;
      margin-bottom: 1.3rem;
      background: #fff;
      border: 1px solid #d0d7de;
      border-radius: 6px;
      box-shadow: 0 1px 0 #e1e4e8;
    }
    .ads-table {
      width: 100%;
      border-collapse: collapse;
      font-size: .99rem;
      min-width: 760px;
      background: #fff;
      table-layout: auto;
    }
    .ads-table th, .ads-table td {
      padding: 0.38em 0.55em;
      border-bottom: 1px solid #d8dee4;
      text-align: left;
      vertical-align: middle;
      font-size: .99rem;
      word-break: break-word;
    }
    .ads-table th {
      background: #f6f8fa;
      color: #24292f;
      font-weight: 700;
      border-bottom: 2px solid #d0d7de;
      font-size: 1.00rem;
    }
    .ads-table tr:last-child td {
      border-bottom: none;
    }
    .ads-table .copy-btn {
      background: #24292f;
      color: #fff;
      border: none;
      border-radius: 6px;
      font-size: .97rem;
      font-weight: 700;
      padding: 0.18em 0.7em;
      cursor: pointer;
      margin-left: 2px;
      transition: background .12s;
    }
    .ads-table .copy-btn:hover { background: #57606a; }
    .ads-table .type-courier {
      background: #ddf4ff;
      border-left: 3px solid #0969da;
    }
    .ads-table .type-sender {
      background: #fff8ec;
      border-left: 3px solid #e3b341;
    }
    .ad-empty {
      text-align: center;
      color: #b2bbcc;
      padding: 1em 0;
      font-size: 1.05rem;
    }
    /* Modal */
    .modal-bg {
      display: none;
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(36,41,47,0.25);
      z-index: 999;
    }
    .modal {
      display: none;
      position: fixed;
      left: 50%;
      top: 50%;
      transform: translate(-50%,-50%);
      background: #fff;
      border: 1px solid #d0d7de;
      border-radius: 8px;
      box-shadow: 0 8px 32px #24292f33;
      padding: 2rem 2.1rem 1.2rem 2.1rem;
      min-width: 330px;
      max-width: 96vw;
      z-index: 1000;
      animation: pop .23s;
    }
    @keyframes pop {
      0% { transform: translate(-50%,-50%) scale(.95);}
      100% { transform: translate(-50%,-50%) scale(1);}
    }
    .modal .form-title {
      font-size: 1.1rem;
      font-weight: 700;
      color: #24292f;
      margin-bottom: .7rem;
      text-align: center;
    }
    .modal .row {
      display: flex;
      gap: .5rem;
      margin-bottom: .3rem;
    }
    .modal label {
      font-weight: 700;
      color: #24292f;
      margin-bottom: 0.11em;
      font-size: .99rem;
      display: block;
    }
    .modal input[type=text], .modal input[type=date], .modal textarea {
      width: 100%;
      padding: .56em .7em;
      margin-bottom: 0.18rem;
      border-radius: 6px;
      border: 1px solid #d0d7de;
      font-size: .97rem;
      background: #f6f8fa;
      font-family: inherit;
      transition: border-color .13s, background .15s;
      color: #24292f;
      box-sizing: border-box;
    }
    .modal input:focus, .modal textarea:focus {
      border-color: #0969da;
      background: #fff;
    }
    .modal textarea {
      min-height: 36px;
      max-height: 80px;
      font-size: .96rem;
      resize: vertical;
    }
    .modal-actions {
      display: flex;
      gap: 1.2em;
      margin-top: .6em;
      justify-content: flex-end;
    }
    .modal .close-btn {
      background: #fff;
      color: #57606a;
      border: 1px solid #d0d7de;
      border-radius: 6px;
      font-weight: 700;
      font-size: 1rem;
      padding: .6em 1.1em;
      cursor: pointer;
      transition: background .13s;
    }
    .modal .close-btn:hover { background: #f6f8fa; }
    .modal .save-btn {
      background: #2da44e;
      color: #fff;
      border: none;
      border-radius: 6px;
      padding: .6em 1.2em;
      font-weight: 700;
      font-size: 1rem;
      cursor: pointer;
      transition: background .14s;
    }
    .modal .save-btn:hover { background: #238636; }
    @media (max-width: 900px) {
      .ads-table, .ads-table th, .ads-table td {
        font-size: .95rem;
      }
      main { max-width: 99vw; padding: 0 2px .8rem 2px;}
      .form-card, .search-panel { padding: .7rem 0.3rem .7rem 0.3rem;}
      .ads-table { min-width: 0; }
    }
    @media (max-width: 650px) {
      .ads-table, .ads-table th, .ads-table td { font-size: .89rem;}
      .ads-table, .ads-table tr, .ads-table td, .ads-table th { display: block;}
      .ads-table thead { display: none;}
      .ads-table tr { margin-bottom: 1rem; border: 1px solid #d0d7de; border-radius: 8px;}
      .ads-table td {
        border-bottom: none;
        padding: 0.37em 0.8em;
        position: relative;
      }
      .ads-table td:before {
        content: attr(data-label) ": ";
        font-weight: 700;
        color: #0969da;
        display: inline-block;
        min-width: 94px;
      }
      .modal { padding: 1.1rem 0.4rem 0.8rem 0.4rem;}
    }
    ::selection { background: #c8e1ff;}
    ::placeholder { color:#b7c9e4; }
  </style>
</head>
<body>
<header>
  <svg class="github-logo" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
    <path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"/>
  </svg>
  Flybox
</header>
<main>
  <div class="top-bar">
    <div class="search-panel">
      <input type="text" id="searchInput" placeholder="Поиск: город, дата, описание..." oninput="renderAds()">
      <button class="search-btn" onclick="renderAds()">Найти</button>
      <div class="filter-switch">
        <span>Тип:</span>
        <button id="filter-all" class="active" onclick="setSearchFilter('all')">Все</button>
        <button id="filter-courier" onclick="setSearchFilter('courier')">Курьеры</button>
        <button id="filter-sender" onclick="setSearchFilter('sender')">Отправить</button>
      </div>
    </div>
    <button class="add-btn" onclick="openAddModal()">+ Добавить объявление</button>
  </div>
  <div class="list-title">Объявления</div>
  <div class="ads-table-container">
    <table class="ads-table" id="adsTable">
      <thead>
        <tr>
          <th>Тип</th>
          <th>Маршрут</th>
          <th>Дата</th>
          <th>Вес/Объем</th>
          <th>Комментарий</th>
          <th>Контакт</th>
          <th></th>
        </tr>
      </thead>
      <tbody id="ads"></tbody>
    </table>
  </div>
  <!-- Модалка добавления -->
  <div class="modal-bg" id="modalBg" onclick="closeAddModal()"></div>
  <form class="modal" id="modalAddForm" onsubmit="addAdModal(event)">
    <div class="form-title">Добавить объявление</div>
    <div class="row">
      <div>
        <label for="modalType">Тип *</label>
        <select id="modalType" required>
          <option value="courier">Курьер (лечу и возьму)</option>
          <option value="sender">Отправить (нужно отправить)</option>
        </select>
      </div>
      <div>
        <label for="modalDate">Дата *</label>
        <input type="date" id="modalDate" required>
      </div>
    </div>
    <div class="row">
      <div>
        <label for="modalFrom">Откуда *</label>
        <input type="text" id="modalFrom" required>
      </div>
      <div>
        <label for="modalTo">Куда *</label>
        <input type="text" id="modalTo" required>
      </div>
    </div>
    <div class="row">
      <div>
        <label for="modalWeight">Вес/объем *</label>
        <input type="text" id="modalWeight" required>
      </div>
      <div>
        <label for="modalContact">Контакты *</label>
        <input type="text" id="modalContact" required>
      </div>
    </div>
    <label for="modalDesc">Комментарий</label>
    <textarea id="modalDesc" placeholder="Что именно и какие условия"></textarea>
    <div class="modal-actions">
      <button type="button" class="close-btn" onclick="closeAddModal()">Отмена</button>
      <button type="submit" class="save-btn">Сохранить</button>
    </div>
  </form>
</main>
<script>
  // Modal logic
  function openAddModal() {
    document.getElementById('modalAddForm').reset();
    document.getElementById('modalType').value = "courier";
    document.getElementById('modalBg').style.display = 'block';
    document.getElementById('modalAddForm').style.display = 'block';
  }
  function closeAddModal() {
    document.getElementById('modalBg').style.display = 'none';
    document.getElementById('modalAddForm').style.display = 'none';
  }
  // Switcher (modal uses select)
  let searchType = 'all';
  function setSearchFilter(type) {
    searchType = type;
    document.getElementById('filter-all').classList.toggle('active', type === 'all');
    document.getElementById('filter-courier').classList.toggle('active', type === 'courier');
    document.getElementById('filter-sender').classList.toggle('active', type === 'sender');
    renderAds();
  }
  // LocalStorage
  let ads = [];
  function loadAds() {
    const raw = localStorage.getItem('flybox_ads');
    ads = raw ? JSON.parse(raw) : [];
  }
  function saveAds() {
    localStorage.setItem('flybox_ads', JSON.stringify(ads));
  }
  function addAdModal(e) {
    e.preventDefault();
    const type = document.getElementById('modalType').value;
    const from = document.getElementById('modalFrom').value.trim();
    const to = document.getElementById('modalTo').value.trim();
    const date = document.getElementById('modalDate').value;
    const weight = document.getElementById('modalWeight').value.trim();
    const desc = document.getElementById('modalDesc').value.trim();
    const contact = document.getElementById('modalContact').value.trim();
    if (!from || !to || !date || !weight || !contact) {
      alert('Заполните все обязательные поля!');
      return;
    }
    ads.push({ type, from, to, date, weight, desc, contact, created: Date.now() });
    saveAds();
    closeAddModal();
    renderAds();
    alert('Объявление добавлено!');
  }
  function renderAds() {
    loadAds();
    const container = document.getElementById('ads');
    const searchText = document.getElementById('searchInput').value.trim().toLowerCase();
    let filtered = ads
      .filter(ad => {
        if (searchType !== 'all' && ad.type !== searchType) return false;
        if (!searchText) return true;
        return (
          (ad.from && ad.from.toLowerCase().includes(searchText)) ||
          (ad.to && ad.to.toLowerCase().includes(searchText)) ||
          (ad.weight && ad.weight.toLowerCase().includes(searchText)) ||
          (ad.desc && ad.desc.toLowerCase().includes(searchText)) ||
          (ad.date && ad.date.includes(searchText))
        );
      })
      .sort((a, b) => new Date(a.date) - new Date(b.date));
    container.innerHTML = '';
    if (!filtered.length) {
      container.innerHTML = `<tr><td colspan="7" class="ad-empty">Нет объявлений</td></tr>`;
      return;
    }
    filtered.forEach((ad, i) => {
      const tr = document.createElement('tr');
      tr.className = (ad.type === 'sender') ? 'type-sender' : 'type-courier';
      tr.innerHTML = `
        <td data-label="Тип">${ad.type === 'courier' ? 'Курьер' : 'Отправить'}</td>
        <td data-label="Маршрут">${ad.from} → ${ad.to}</td>
        <td data-label="Дата">${ad.date}</td>
        <td data-label="Вес/Объем">${ad.type === 'courier' ? `До ${ad.weight} кг` : ad.weight}</td>
        <td data-label="Комментарий">${ad.desc || ''}</td>
        <td data-label="Контакт"><span id="contact${i}">${ad.contact}</span></td>
        <td data-label="">
          <button class="copy-btn" onclick="copyContact(${i})">📋</button>
        </td>
      `;
      container.appendChild(tr);
    });
  }
  function copyContact(index) {
    const contactText = document.getElementById(`contact${index}`).innerText;
    navigator.clipboard.writeText(contactText)
      .then(() => alert(`Контакт скопирован:\n${contactText}`))
      .catch(() => alert('Не удалось скопировать контакт'));
  }
  window.onload = renderAds;
</script>
</body>
</html>
